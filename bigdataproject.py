# -*- coding: utf-8 -*-
"""BigDataProject (1).ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/16hT6VdAny2ahVzRN1lnMBucjZuoDmbDd
"""

#ë¶ê·¹/ë‚¨ê·¹ í•´ë¹™ ë³€í™” 10ë…„ ë°ì´í„°

import pandas as pd
import glob


df_n = pd.read_csv("/content/N_09_extent_v4.0.csv")
df_n = df_n.replace(-9999, pd.NA)

latest_year_n = df_n["year"].max()
start_year_n = latest_year_n - 10

last10_n = df_n[(df_n["year"] >= start_year_n) & (df_n["year"] <= latest_year_n)]

yearly_n = df_n.groupby(["year"," region"])[" extent"].mean().reset_index()
yearly_n

#ë‚¨ê·¹
file_list_s = glob.glob("/content/South/*.csv")

dfs_s = []

for file in file_list_s:
    df_s = pd.read_csv(file)
    df_s = df_s.replace(-9999, pd.NA)
    dfs_s.append(df_s)

full_df_s = pd.concat(dfs_s, ignore_index=True)
full_df_s = full_df_s.sort_values(by=["year", " mo"]).reset_index(drop=True)

latest_year_s = full_df_s["year"].max()
start_year_s = latest_year_s - 10

last10_s = full_df_s[(full_df_s["year"] >= start_year_s) & (full_df_s["year"] <= latest_year_s)]

last10_s.head(), last10_s.tail()

yearly_s = full_df_s.groupby(["year"," region"])[" extent"].mean().reset_index()
yearly_s

df = pd.read_csv('/content/GLB.Ts+dSST.csv', header=1)

df = df.replace('***', pd.NA)
df['J-D'] = pd.to_numeric(df['J-D'], errors='coerce')

df_jd = df[['Year', 'J-D']]
print(df_jd)

sea_level = pd.read_csv('/content/GMSL_TPJAOS_5.2.txt',
                        sep=r'\s+', header=None)

df_selected = sea_level.iloc[:, [2, 8]].copy()
df_selected.columns = ['year_fraction', 'GMSL_GIA']

import plotly.graph_objects as go
from plotly.subplots import make_subplots

# ë°ì´í„° ì •ë¦¬ (ê¸°ì¡´ ì½”ë“œ)
yearly_n = yearly_n.rename(columns=lambda x: x.strip())
yearly_s = yearly_s.rename(columns=lambda x: x.strip())

yearly_n["region"] = yearly_n["region"].astype(str).str.strip().str.upper()
yearly_s["region"] = yearly_s["region"].astype(str).str.strip().str.upper()

yearly_n["extent"] = pd.to_numeric(yearly_n["extent"], errors="coerce")
yearly_s["extent"] = pd.to_numeric(yearly_s["extent"], errors="coerce")

# ---------------------------------------------
# ë°©ë²• 1: ì„œë¸Œí”Œë¡¯ìœ¼ë¡œ ë¶ê·¹/ë‚¨ê·¹ ë”°ë¡œ ë³´ê¸° (ì¶”ì²œ!)
# ---------------------------------------------
fig = make_subplots(
    rows=1, cols=2,
    subplot_titles=("Arctic Sea Ice", "Antarctic Sea Ice"),
    specs=[[{"type": "geo"}, {"type": "geo"}]]
)

years = sorted(yearly_n["year"].unique())

for y in years:
    n_data = yearly_n[yearly_n["year"] == y]
    s_data = yearly_s[yearly_s["year"] == y]

    # ë¶ê·¹
    fig.add_trace(go.Scattergeo(
        lat=[82],
        lon=[0],
        mode="markers+text",
        text=[f"Arctic<br>{n_data['extent'].values[0]:.2f}"],
        textposition="bottom center",
        marker=dict(
            size=n_data["extent"].values[0] * 15,
            color="blue",
            opacity=0.7
        ),
        name=f"Arctic {y}",
        visible=False,
        showlegend=False
    ), row=1, col=1)

    # ë‚¨ê·¹
    fig.add_trace(go.Scattergeo(
        lat=[-82],
        lon=[0],
        mode="markers+text",
        text=[f"Antarctic<br>{s_data['extent'].values[0]:.2f}"],
        textposition="top center",
        marker=dict(
            size=s_data["extent"].values[0] * 15,
            color="cyan",
            opacity=0.7
        ),
        name=f"Antarctic {y}",
        visible=False,
        showlegend=False
    ), row=1, col=2)

# ì²« í•´ë§Œ ë³´ì´ê²Œ
fig.data[0].visible = True
fig.data[1].visible = True

# ìŠ¬ë¼ì´ë”
steps = []
for i, y in enumerate(years):
    step = dict(
        method="update",
        args=[
            {"visible": [False] * len(fig.data)},
            {"title": f"Sea Ice Extent - {y}"}
        ],
        label=str(y)
    )
    step["args"][0]["visible"][i*2] = True
    step["args"][0]["visible"][i*2 + 1] = True
    steps.append(step)

sliders = [dict(
    active=0,
    steps=steps,
    currentvalue={"prefix": "Year: "}
)]

fig.update_geos(
    projection_type="orthographic",
    showland=True,
    landcolor="lightgray",
    oceancolor="lightblue",
    showcountries=True
)

fig.update_layout(
    title="Arctic & Antarctic Sea Ice Extent Over Time",
    sliders=sliders,
    height=500
)

fig.show()

# ---------------------------------------------
# ë°©ë²• 2: ì‹œê³„ì—´ ë¼ì¸ ì°¨íŠ¸ (ê°€ì¥ ëª…í™•!)
# ---------------------------------------------
fig2 = go.Figure()

fig2.add_trace(go.Scatter(
    x=yearly_n["year"],
    y=yearly_n["extent"],
    mode="lines+markers",
    name="Arctic",
    line=dict(color="blue", width=3),
    marker=dict(size=6)
))

fig2.add_trace(go.Scatter(
    x=yearly_s["year"],
    y=yearly_s["extent"],
    mode="lines+markers",
    name="Antarctic",
    line=dict(color="cyan", width=3),
    marker=dict(size=6)
))

fig2.update_layout(
    title="Sea Ice Extent Trends",
    xaxis_title="Year",
    yaxis_title="Ice Extent (million kmÂ²)",
    hovermode="x unified",
    template="plotly_white",
    height=500
)

fig2.show()

import pandas as pd
import plotly.graph_objects as go
from plotly.subplots import make_subplots
import numpy as np

# ë°ì´í„° ë¡œë“œ ë° ì •ë¦¬
temperature = pd.read_csv('/content/GLB.Ts+dSST.csv', header=1)
temperature = temperature.replace('***', pd.NA)
temperature['J-D'] = pd.to_numeric(temperature['J-D'], errors='coerce')
temperature_jd = temperature[['Year', 'J-D']].dropna()

# ---------------------------------------------
# ë°©ë²• 2: ìƒ‰ìƒìœ¼ë¡œ ì˜¨ë‚œí™” í‘œí˜„ (íˆíŠ¸ë§µ ìŠ¤íƒ€ì¼)
# ---------------------------------------------
fig2 = go.Figure()

fig2.add_trace(go.Bar(
    x=temperature_jd['Year'],
    y=temperature_jd['J-D'],
    marker=dict(
        color=temperature_jd['J-D'],
        colorscale='RdBu_r',  # íŒŒë€ìƒ‰(ì°¨ê°€ì›€) -> ë¹¨ê°„ìƒ‰(ë”ì›€)
        colorbar=dict(title='ì˜¨ë„ í¸ì°¨ (Â°C)'),
        cmin=-0.5,
        cmax=1.5
    ),
    hovertemplate='ì—°ë„: %{x}<br>ì˜¨ë„ í¸ì°¨: %{y:.2f}Â°C<extra></extra>'
))

fig2.add_hline(y=0, line_dash="solid", line_color="black", line_width=2)

fig2.update_layout(
    title='ì˜¨ë„ í¸ì°¨ ì‹œê°í™”: ì˜¨ë‚œí™” ë§‰ëŒ€ ê·¸ë˜í”„',
    xaxis_title='ì—°ë„',
    yaxis_title='ì˜¨ë„ í¸ì°¨ (Â°C)',
    template='plotly_white',
    height=500,
    font=dict(family="Arial, sans-serif")
)

fig2.show()

# ---------------------------------------------
# ë°©ë²• 3: 10ë…„ í‰ê·  ì´ë™í‰ê·  + ì›ë³¸ ë°ì´í„°
# ---------------------------------------------
fig3 = go.Figure()

# ì›ë³¸ ë°ì´í„° (ì—°í•œ ìƒ‰)
fig3.add_trace(go.Scatter(
    x=temperature_jd['Year'],
    y=temperature_jd['J-D'],
    mode='lines',
    name='ì—°ê°„ ë°ì´í„°',
    line=dict(color='lightcoral', width=1),
    opacity=0.5
))

# 10ë…„ ì´ë™í‰ê· 
temperature_jd['MA_10'] = temperature_jd['J-D'].rolling(window=10, center=True).mean()

fig3.add_trace(go.Scatter(
    x=temperature_jd['Year'],
    y=temperature_jd['MA_10'],
    mode='lines',
    name='10ë…„ ì´ë™í‰ê· ',
    line=dict(color='darkred', width=4)
))

fig3.add_hline(y=0, line_dash="dot", line_color="gray")

fig3.update_layout(
    title='ì „ì§€êµ¬ ì˜¨ë„ í¸ì°¨ ë° 10ë…„ ì´ë™í‰ê· ',
    xaxis_title='ì—°ë„',
    yaxis_title='ì˜¨ë„ í¸ì°¨ (Â°C)',
    hovermode='x unified',
    template='plotly_white',
    height=600,
    font=dict(family="Arial, sans-serif")
)

fig3.show()

# ---------------------------------------------
# í†µê³„ ì •ë³´ ì¶œë ¥
# ---------------------------------------------
print("\nğŸ“Š ì˜¨ë„ ë°ì´í„° í†µê³„:")
print(f"ë°ì´í„° ë²”ìœ„: {temperature_jd['Year'].min():.0f}ë…„ - {temperature_jd['Year'].max():.0f}ë…„")
print(f"ê°€ì¥ ì¶”ì› ë˜ í•´: {temperature_jd.loc[temperature_jd['J-D'].idxmin(), 'Year']:.0f}ë…„ ({temperature_jd['J-D'].min():.2f}Â°C)")
print(f"ê°€ì¥ ë”ì› ë˜ í•´: {temperature_jd.loc[temperature_jd['J-D'].idxmax(), 'Year']:.0f}ë…„ ({temperature_jd['J-D'].max():.2f}Â°C)")
print(f"í‰ê·  ì˜¨ë„ í¸ì°¨ (1880-2024): {temperature_jd['J-D'].mean():.2f}Â°C")
print(f"í‰ê·  ì˜¨ë„ í¸ì°¨ (2000-2024): {temperature_jd[temperature_jd['Year'] >= 2000]['J-D'].mean():.2f}Â°C")
print(f"ì˜¨ë‚œí™” ì†ë„: ì—°ê°„ {z[0]:.4f}Â°C ìƒìŠ¹")
print(f"ì´ ì˜¨ë‚œí™” (1880-2024): {(z[0] * (2024-1880)):.2f}Â°C")

# ìµœê·¼ 10ë…„ í‰ê· 
recent_10 = temperature_jd.tail(10)['J-D'].mean()
print(f"ìµœê·¼ 10ë…„ í‰ê· : {recent_10:.2f}Â°C")

import pandas as pd
import plotly.graph_objects as go
import numpy as np

# ë°ì´í„° ë¡œë“œ
sea_level = pd.read_csv('/content/GMSL_TPJAOS_5.2.txt', sep=r'\s+', header=None)
df_selected = sea_level.iloc[:, [2, 8]].copy()
df_selected.columns = ['year_fraction', 'GMSL_GIA']

# ì—°ë„ë¥¼ ì •ìˆ˜ë¡œ ë³€í™˜
df_selected['year'] = df_selected['year_fraction'].astype(int)

# ---------------------------------------------
# ê·¸ë˜í”„ 1: ê¸°ë³¸ ë¼ì¸ ì°¨íŠ¸ + ì¶”ì„¸ì„ 
# ---------------------------------------------
fig1 = go.Figure()

# ì‹¤ì œ í•´ìˆ˜ë©´ ë°ì´í„°
fig1.add_trace(go.Scatter(
    x=df_selected['year_fraction'],
    y=df_selected['GMSL_GIA'],
    mode='lines',
    name='í•´ìˆ˜ë©´ ë†’ì´',
    line=dict(color='rgb(37, 99, 235)', width=2),
    hovertemplate='ì—°ë„: %{x:.2f}<br>í•´ìˆ˜ë©´: %{y:.2f}mm<extra></extra>'
))

# ì¶”ì„¸ì„ 
z = np.polyfit(df_selected['year_fraction'], df_selected['GMSL_GIA'], 1)
p = np.poly1d(z)
fig1.add_trace(go.Scatter(
    x=df_selected['year_fraction'],
    y=p(df_selected['year_fraction']),
    mode='lines',
    name=f'ì¶”ì„¸ì„  (ì—°ê°„ ìƒìŠ¹ë¥ : {z[0]:.2f}mm)',
    line=dict(color='darkblue', width=3, dash='dash')
))

fig1.update_layout(
    title='ì „ì§€êµ¬ í‰ê·  í•´ìˆ˜ë©´ ë³€í™” (1993-2025)<br><sub>ìœ„ì„± ê´€ì¸¡ ë°ì´í„° (GIA ë³´ì • ì ìš©)</sub>',
    xaxis_title='ì—°ë„',
    yaxis_title='í•´ìˆ˜ë©´ ë†’ì´ (mm)',
    hovermode='x unified',
    template='plotly_white',
    height=600,
    font=dict(family="Arial, sans-serif")
)

fig1.show()

# ---------------------------------------------
# ê·¸ë˜í”„ 2: ì—°ë„ë³„ í•´ìˆ˜ë©´ ìƒìŠ¹ëŸ‰ (ë°” ì°¨íŠ¸)
# ---------------------------------------------
# ì—°í‰ê·  ê³„ì‚°
yearly_avg = df_selected.groupby('year')['GMSL_GIA'].mean().reset_index()
yearly_avg['ìƒìŠ¹ëŸ‰'] = yearly_avg['GMSL_GIA'].diff()

fig2 = go.Figure()

fig2.add_trace(go.Bar(
    x=yearly_avg['year'],
    y=yearly_avg['ìƒìŠ¹ëŸ‰'],
    marker=dict(
        color=yearly_avg['ìƒìŠ¹ëŸ‰'],
        colorscale='Blues',
        colorbar=dict(title='ìƒìŠ¹ëŸ‰ (mm)')
    ),
    hovertemplate='ì—°ë„: %{x}<br>ì „ë…„ ëŒ€ë¹„ ìƒìŠ¹: %{y:.2f}mm<extra></extra>'
))

fig2.update_layout(
    title='ì—°ê°„ í•´ìˆ˜ë©´ ìƒìŠ¹ëŸ‰',
    xaxis_title='ì—°ë„',
    yaxis_title='ì „ë…„ ëŒ€ë¹„ ìƒìŠ¹ëŸ‰ (mm)',
    template='plotly_white',
    height=500,
    font=dict(family="Arial, sans-serif")
)

fig2.show()

# í†µê³„ ì •ë³´
print("\nğŸŒŠ í•´ìˆ˜ë©´ ë³€í™” í†µê³„:")
print(f"ë°ì´í„° ë²”ìœ„: {df_selected['year_fraction'].min():.2f}ë…„ - {df_selected['year_fraction'].max():.2f}ë…„")
print(f"ì´ ìƒìŠ¹ëŸ‰: {df_selected['GMSL_GIA'].iloc[-1] - df_selected['GMSL_GIA'].iloc[0]:.2f}mm")
print(f"í‰ê·  ìƒìŠ¹ ì†ë„: {z[0]:.2f}mm/ë…„")

import pandas as pd
import plotly.graph_objects as go
from plotly.subplots import make_subplots
import numpy as np

# ---------------------------------------------
# ë°ì´í„° ë¡œë“œ ë° ì •ë¦¬
# ---------------------------------------------

# í•´ìˆ˜ë©´ ë°ì´í„°
sea_level = pd.read_csv('/content/GMSL_TPJAOS_5.2.txt', sep=r'\s+', header=None)
df_sea = sea_level.iloc[:, [2, 8]].copy()
df_sea.columns = ['year_fraction', 'GMSL_GIA']

# ê¸°ì˜¨ ë°ì´í„°
temperature = pd.read_csv('/content/GLB.Ts+dSST.csv', header=1)
temperature = temperature.replace('***', pd.NA)
temperature['J-D'] = pd.to_numeric(temperature['J-D'], errors='coerce')
df_temp = temperature[['Year', 'J-D']].dropna()
df_temp.columns = ['year', 'temperature']

# í•´ë¹™ ë°ì´í„° (ë¶ê·¹ + ë‚¨ê·¹)
yearly_n = yearly_n.rename(columns=lambda x: x.strip())
yearly_s = yearly_s.rename(columns=lambda x: x.strip())
yearly_n["extent"] = pd.to_numeric(yearly_n["extent"], errors="coerce")
yearly_s["extent"] = pd.to_numeric(yearly_s["extent"], errors="coerce")

df_ice_n = yearly_n[['year', 'extent']].copy()
df_ice_n.columns = ['year', 'arctic']
df_ice_s = yearly_s[['year', 'extent']].copy()
df_ice_s.columns = ['year', 'antarctic']

df_ice = pd.merge(df_ice_n, df_ice_s, on='year')

# ê³µí†µ ì—°ë„ ë²”ìœ„ (1993-2024)
common_years = range(1993, 2025)

# ê° ë°ì´í„°ë¥¼ ê³µí†µ ì—°ë„ë¡œ í•„í„°ë§
df_temp_common = df_temp[df_temp['year'].isin(common_years)]
df_sea_common = df_sea[(df_sea['year_fraction'] >= 1993) & (df_sea['year_fraction'] < 2025)]
df_ice_common = df_ice[df_ice['year'].isin(common_years)]

# í•´ìˆ˜ë©´ ë°ì´í„°ë¥¼ ì—°í‰ê· ìœ¼ë¡œ
df_sea_common['year'] = df_sea_common['year_fraction'].astype(int)
df_sea_yearly = df_sea_common.groupby('year')['GMSL_GIA'].mean().reset_index()

# ì •ê·œí™” í•¨ìˆ˜
def normalize(series):
    return (series - series.min()) / (series.max() - series.min()) * 100

# ë°ì´í„° ë³‘í•©
merged = df_temp_common.merge(df_sea_yearly, on='year')
merged = merged.merge(df_ice_common[['year', 'arctic', 'antarctic']], on='year')

# ì •ê·œí™”ëœ ê°’ ê³„ì‚°
temp_norm = normalize(df_temp_common['temperature'])
sea_norm = normalize(df_sea_yearly['GMSL_GIA'])
arctic_norm = 100 - normalize(df_ice_common['arctic'])  # ê°ì†Œì´ë¯€ë¡œ ë°˜ì „

# ---------------------------------------------
# ìƒê´€ê´€ê³„ ëŒ€ì‹œë³´ë“œ
# ---------------------------------------------
fig = make_subplots(
    rows=1, cols=3,
    subplot_titles=(
        'ê¸°ì˜¨ vs í•´ìˆ˜ë©´',
        'ê¸°ì˜¨ vs ë¶ê·¹ í•´ë¹™',
        'ì—°ë„ë³„ ì¢…í•© ë³€í™”ìœ¨'
    ),
    specs=[[
        {"type": "scatter"},
        {"type": "scatter"},
        {"type": "bar"}
    ]],
    vertical_spacing=0.15,
    horizontal_spacing=0.12
)

# 1) ê¸°ì˜¨ vs í•´ìˆ˜ë©´ (ì‚°ì ë„)
fig.add_trace(
    go.Scatter(
        x=merged['temperature'],
        y=merged['GMSL_GIA'],
        mode='markers',
        marker=dict(
            color=merged['year'],
            colorscale='Viridis',
            size=10,
            showscale=True,
            colorbar=dict(title="ì—°ë„", x=1.05, len=0.6)
        ),
        text=merged['year'],
        hovertemplate='ê¸°ì˜¨: %{x:.2f}Â°C<br>í•´ìˆ˜ë©´: %{y:.2f}mm<br>ì—°ë„: %{text}<extra></extra>'
    ),
    row=1, col=1
)

# 2) ê¸°ì˜¨ vs ë¶ê·¹ í•´ë¹™ (ì‚°ì ë„)
fig.add_trace(
    go.Scatter(
        x=merged['temperature'],
        y=merged['arctic'],
        mode='markers',
        marker=dict(
            color=merged['year'],
            colorscale='Plasma',
            size=10,
            showscale=False
        ),
        text=merged['year'],
        hovertemplate='ê¸°ì˜¨: %{x:.2f}Â°C<br>ë¶ê·¹: %{y:.2f} million kmÂ²<br>ì—°ë„: %{text}<extra></extra>'
    ),
    row=1, col=2
)
# 4) ì—°ë„ë³„ ë³€í™”ìœ¨ (ë°” ì°¨íŠ¸)
merged['temp_change'] = merged['temperature'].diff()
merged['sea_change'] = merged['GMSL_GIA'].diff()
merged['ice_change'] = merged['arctic'].diff()

fig.add_trace(
    go.Bar(
        x=merged['year'],
        y=merged['temp_change'],
        name='ê¸°ì˜¨ ë³€í™”',
        marker_color='rgba(220, 38, 38, 0.7)',
        hovertemplate='ì—°ë„: %{x}<br>ì „ë…„ ëŒ€ë¹„: %{y:.3f}Â°C<extra></extra>'
    ),
    row=1, col=3
)

# ë ˆì´ì•„ì›ƒ ì„¤ì •
fig.update_xaxes(title_text="ê¸°ì˜¨ í¸ì°¨ (Â°C)", row=1, col=1)
fig.update_yaxes(title_text="í•´ìˆ˜ë©´ (mm)", row=1, col=1)
fig.update_xaxes(title_text="ê¸°ì˜¨ í¸ì°¨ (Â°C)", row=1, col=2)
fig.update_yaxes(title_text="ë¶ê·¹ í•´ë¹™ (million kmÂ²)", row=1, col=2)
fig.update_xaxes(title_text="ì—°ë„", row=2, col=1)
fig.update_yaxes(title_text="ì •ê·œí™” ê°’ (0-100)", row=2, col=1)
fig.update_xaxes(title_text="ì—°ë„", row=2, col=2)
fig.update_yaxes(title_text="ì „ë…„ ëŒ€ë¹„ ë³€í™” (Â°C)", row=2, col=2)

fig.update_layout(
    title_text='ê¸°í›„ ë³€í™” ìƒê´€ê´€ê³„ ë¶„ì„ ëŒ€ì‹œë³´ë“œ<br><sub>1993-2024ë…„ ë°ì´í„° ê¸°ë°˜</sub>',
    height=500,
    template='plotly_white',
    showlegend=True,
    font=dict(family="Arial, sans-serif"),
    hovermode='closest'
)

fig.show()

# ---------------------------------------------
# í†µê³„ ìš”ì•½
# ---------------------------------------------
print("\nğŸ“Š ê¸°í›„ ë³€í™” ì¢…í•© í†µê³„ (1993-2024):")
print("\nğŸŒ¡ï¸ ê¸°ì˜¨:")
print(f"  í‰ê·  ìƒìŠ¹: {df_temp_common['temperature'].mean():.2f}Â°C")
print(f"  ìµœëŒ€ê°’: {df_temp_common['temperature'].max():.2f}Â°C ({df_temp_common.loc[df_temp_common['temperature'].idxmax(), 'year']:.0f}ë…„)")
print(f"  ì´ ìƒìŠ¹: {df_temp_common['temperature'].iloc[-1] - df_temp_common['temperature'].iloc[0]:.2f}Â°C")

print("\nğŸŒŠ í•´ìˆ˜ë©´:")
print(f"  ì´ ìƒìŠ¹: {df_sea_yearly['GMSL_GIA'].iloc[-1] - df_sea_yearly['GMSL_GIA'].iloc[0]:.2f}mm")
print(f"  ì—°í‰ê·  ìƒìŠ¹ë¥ : {(df_sea_yearly['GMSL_GIA'].iloc[-1] - df_sea_yearly['GMSL_GIA'].iloc[0]) / len(df_sea_yearly):.2f}mm/ë…„")

print("\nğŸ§Š ë¶ê·¹ í•´ë¹™:")
print(f"  ì´ ê°ì†Œ: {df_ice_common['arctic'].iloc[0] - df_ice_common['arctic'].iloc[-1]:.2f} million kmÂ²")
print(f"  ê°ì†Œìœ¨: {((df_ice_common['arctic'].iloc[0] - df_ice_common['arctic'].iloc[-1]) / df_ice_common['arctic'].iloc[0] * 100):.1f}%")

print("\nğŸ§Š ë‚¨ê·¹ í•´ë¹™:")
print(f"  ë³€í™”: {df_ice_common['antarctic'].iloc[-1] - df_ice_common['antarctic'].iloc[0]:.2f} million kmÂ²")

# ìƒê´€ê³„ìˆ˜ ê³„ì‚°
from scipy.stats import pearsonr

corr_temp_sea, p_temp_sea = pearsonr(merged['temperature'], merged['GMSL_GIA'])
corr_temp_ice, p_temp_ice = pearsonr(merged['temperature'], merged['arctic'])

print("\nğŸ“ˆ ìƒê´€ê´€ê³„:")
print(f"  ê¸°ì˜¨-í•´ìˆ˜ë©´ ìƒê´€ê³„ìˆ˜: {corr_temp_sea:.3f} (p-value: {p_temp_sea:.4f})")
print(f"  ê¸°ì˜¨-ë¶ê·¹í•´ë¹™ ìƒê´€ê³„ìˆ˜: {corr_temp_ice:.3f} (p-value: {p_temp_ice:.4f})")